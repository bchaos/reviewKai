(function(){var e,t,r,n,o,a,i,s,l,u,c,m,f;e=angular.module("reviewApp",["ngAnimate","ngRoute","ngResource","ngSanitize","ionic"],function(e){return e.when("/library",{templateUrl:"views/library.html",controller:"libraryController"}),e.when("/guru",{templateUrl:"views/library.html",controller:"guruController"}),e.when("/",{templateUrl:"views/home.html",controller:"homeController"}),e.when("/home",{templateUrl:"views/home.html",controller:"homeController"}),e.when("/faqs",{templateUrl:"views/faqs.html"}),e.when("/contact",{templateUrl:"views/contact.html",controller:"genericController"}),e.when("/PrivacyPolicy",{templateUrl:"views/PrivacyPolicy.html",controller:"genericController"}),e.when("/recommendations",{templateUrl:"views/recommendations.html",controller:"recommendationController"}),e.when("/blog",{templateUrl:"views/blog.html"}),e.when("/peer",{templateUrl:"views/library.html",controller:"peerController"}),e.when("/dashboard",{templateUrl:"views/dashboard.html",controller:"dashboardController"}),e.when("/settings",{templateUrl:"views/settings.html",controller:"s"}),e.when("/search",{templateUrl:"views/search.html",controller:"searchController"}),e.otherwise({templateUrl:"views/library.html",controller:"libraryController"})}),e.directive("platfromcard",function(){return{restrict:"E",templateUrl:"views/platformcard.html"}}),e.directive("card",function(){return{restrict:"E",templateUrl:"views/card.html"}}),e.directive("searching",function(){return{restrict:"E",templateUrl:"views/searching.html"}}),e.directive("librarycard",function(){return{restrict:"E",templateUrl:"views/librarycard.html"}}),e.directive("searchcard",function(){return{restrict:"E",templateUrl:"views/searchcard.html"}}),e.config(function(e){return e.defaults.useXDomain=!0,delete e.defaults.headers.common["X-Requested-With"]}),e.service("socket",function(e){var t;return t=io.connect("http://166.78.129.57:8080"),{on:function(r,n){return t.on(r,function(){var r;return r=arguments,e.$apply(function(){return n.apply(t,r)})})},emit:function(r,n,o){return t.emit(r,n,function(){var r;return r=arguments,e.$apply(function(){return o?o.apply(t,r):void 0})})}}}),e.factory("InfoRequestService",["$http",function(e){var t;return new(t=function(){function t(){}return t.prototype.searchForAGame=function(t,r){var n;return n="http://www.giantbomb.com/api/search/?api_key=059d37ad5ca7f47e566180366eab2190e8c6da30&query="+t+"&field_list=name,image,id,deck,original_release_date,platforms,genres&resources=game&format=jsonp&json_callback=JSON_CALLBACK",e.jsonp(n).success(function(e){return r(e)})},t.prototype.getDeckForGame=function(t,r){var n;return n="http://www.giantbomb.com/api/game/"+t+"/?api_key=059d37ad5ca7f47e566180366eab2190e8c6da30&field_list=platforms,deck,genres,videos,original_release_date&format=jsonp&json_callback=JSON_CALLBACK",e.jsonp(n).success(function(e){return r(e)})},t.prototype.getMetaData=function(t,r){return e.get(t).success(function(e){return r(e)})},t}())}]),e.filter("myLimitTo",[function(){return function(e,t,r){var n,o,a,i;return o=Object.keys(e),o.length<1?[]:(a=new Object,n=0,i=0,angular.forEach(o,function(o){return n>=t?!1:i>=r?(a[o]=e[o],n++):i>=r++}),a)}}]),i=function(e,t){return window.localStorage.sessionkey?e.emit("isUserLoggedin",{key:window.localStorage.sessionkey,location:t}):void 0},t=function(e,t,r,n){var o;return t.newOffset=0,t.itemsPerPage=t.myLibrary&&t.localLibrary?11:12,t.currentPage=0,t.onCurrentPage=function(e){return e===t.currentPage?"button-balanced":"button-stable"},t.setUpPages=function(){var e;return e=Math.ceil(t.games.length/t.itemsPerPage),t.maxPages=e,t.pages=[],o()},o=function(){var e,r,n,o,a,i;for(o=t.maxPages,e=0,t.pages=[],a=9,r=!1,t.maxPages>a+1&&t.currentPage+4>=t.maxPages-1?(e=t.maxPages-a,o=t.maxPages):t.maxPages>a+1&&t.currentPage>=a-1?(e=t.currentPage-4,o=t.currentPage+4):t.maxPages>a+1&&(o=a),e>0&&(t.pages.push({number:0,startingPoint:0}),t.pages.push({elispe:!0,number:!1})),n=i=e;o>=e?o>i:i>o;n=o>=e?++i:--i)t.pages.push({number:n,startingPoint:n*t.itemsPerPage});return o<t.maxPages-1?(t.pages.push({elispe:!0,number:!1}),t.pages.push({number:t.maxPages-1,startingPoint:(t.maxPages-1)*t.itemsPerPage})):void 0},t.setPage=function(e){return e>=0&&e<t.maxPages?(t.currentPage=e,t.newOffset=t.currentPage*t.itemsPerPage,o()):void 0},t.gameDetails={},t.sort="-releasedate",t.convertMyRating=function(e){var t;return e>10&&(e/=20),e>5&&(e/=2),t=function(){switch(!1){case 1!==e:return"This game is  unplayable";case 2!==e:return"Bad but playable in a pinch";case 3!==e:return"A fairly average game";case 4!==e:return"Good game with some minor flaws";default:return"A nearly flawless gameplay experience"}}()},t.convertAverageLibraryClass=function(e,r,n){return t.convertAverageClass(n?r:e)},t.convertAverageClass=function(e){var t;return e&&0!==e?t=function(){switch(!1){case!(1.5>e):return"negative";case!(2.5>e):return"negative";case!(3.5>e):return"ok";case!(4>e):return"ok";case!(4.5>e):return"postive";default:return"postive"}}():"unknown"},t.convertRating=function(e){var t;return t=function(){switch(!1){case!(1.5>e):return"You should avoid this game!";case!(2.5>e):return"Do not waste your time.";case!(3.5>e):return"This game is below average.";case!(4>e):return"You will find this game to be ok.";case!(4.5>e):return"You should play this one!";default:return"You will love this game!"}}()},t.getGameStyle=function(e){return{background:'url("'+e+'")',"background-size":"100% 150%","background-repeat":"no-repeat","background-position":"center"}},t.colorForScore=function(e){var t;return t=function(){switch(!1){case!(1.5>e):return{color:"red","font-size":"12px"};case!(2.5>e):return{color:"red","font-size":"12px"};case!(3.5>e):return{color:"#E6C805","font-size":"12px"};case!(4>e):return{color:"#E6C805","font-size":"12px"};case!(4.5>e):return{color:"green","font-size":"12px"};default:return{color:"green","font-size":"12px"}}}()},e.fromTemplateUrl("views/gameDetailsModal.html",{scope:t,animation:"slide-in-up"}).then(function(e){return t.gameDetailsModal=e}),t.showGameDescription=function(e,r,o){return t.gameDetailsModal.show(),t.gamedetails={},n.getDeckForGame(e,function(e){return t.gamedetails=e.results,t.gamedetails.name=r,t.gamedetails.image=o})},t.closeGameDes=function(){return t.gameDetailsModal.hide()},e.fromTemplateUrl("views/detailsGuruModal.html",{scope:t,animation:"slide-in-up"}).then(function(e){return t.guruModal=e,t.modalGame={}}),t.getGuruDetails=function(e){return t.guruModal.show(),r.emit("getGuruDetails",{gameid:e}),t.guruInfoLoading=!0,r.on("guruDetailsFound",function(e){return t.gameDetails=e,t.guruInfoLoading=!1})},t.closeGuru=function(){return t.guruModal.hide()},t.closePeer=function(){return t.peerModal.hide()},t.getPeerDetails=function(e){return t.peerModal.show(),r.emit("getPeerDetails",{gameid:e}),t.peerInfoLoading=!0,r.on("peerDetailsFound",function(e){return t.gameDetails=e,t.peerInfoLoading=!1})},e.fromTemplateUrl("views/detailsPeerModal.html",{scope:t,animation:"slide-in-up"}).then(function(e){return t.peerModal=e,t.modalGame={}})},f=function(e,t,r){var n;return t.fromTemplateUrl("views/signupSignInModal.html",{scope:e,animation:"slide-in-up"}).then(function(t){return e.modal=t,e.logdata={}}),r.on("NeedUsername",function(){return e.modal.show(),e.needUsername=!0}),e.createUsername=function(){return r.emit("addUsername",e.logdata.name)},r.on("usernameAdded",function(){return e.closeModal()}),n=function(t){switch(!1){case"connected"!==t.status:return FB.api("/me",function(e){return r.emit("loginToFaceBook",e)});case"not_authorized"!==t.status:return e.errormessage="You are not authorized";default:return e.errormessage="You are not authorized"}},window.checkLoginState=function(){return FB.getLoginStatus(function(e){return n(e)})},e.errormessage=!1,e.closeModal=function(){return e.logdata={},e.modal.hide()},e.signUpModal=function(){return e.modal.show(),e.signUp=!0},e.signInModal=function(){return e.modal.show(),e.signUp=!1},e.signInOrSignUpNow=function(){return e.signUp?e.signUpNow():e.signInNow()},e.signInNow=function(){var t;return t={},t.username=e.logdata.username,t.password=e.logdata.temppassword,r.emit("Login",t)},e.signUpNow=function(){var t,n;return e.logdata.password={},t={},n={},e.logdata.temppassword===e.logdata.repeat?(t.username=e.logdata.username,t.password=e.logdata.temppassword,t.name=e.logdata.name,r.emit("SignUpUser",t)):e.errormessage="Passwords do not match"},r.on("UserEmailAlreadyExists",function(){return e.errormessage="The user already exits"}),r.on("UserEmailNotFound",function(){return e.errormessage="Email not valid"}),r.on("failureMessage",function(t){return e.errormessage=t}),r.on("userLoggedin",function(){return e.closeModal()})},e.controller("reviewController",c=function(){function e(e,t,r,n,o){this.$scope=e,this.InfoRequestService=t,this.$location=r,this.socket=n,e.toggleClass=function(){return e.active="false"===e.active?"true":"false"},e.accessList=!1,"/home"!==r.path()&&"/"!==r.path()&&i(n,r.path()),e.loggedin=!0,f(e,o,n),n.on("userLoggedin",function(t){return e.accessList=t.accessList,localStorage.setItem("sessionkey",t.sessionKey)}),this.$scope.homeSelected="button-stable",this.$scope.logout=function(){return localStorage.removeItem("sessionkey"),window.location="#/home",e.accessList=!1},this.$scope.librarySelected="button-stable",this.$scope.recomendationSeleted="button-stable",this.$scope.isActive=function(e){var t;return e="/"+e,e===(t=r.path())?"pure-menu-selected":""}}return e.$inject=["$scope","InfoRequestService","$location","socket","$ionicModal"],e}()),e.controller("homeController",a=function(){function e(e,t,r){this.$scope=e,this.socket=r,e.loggedin=!1,window.localStorage.sessionkey&&r.emit("isUserLoggedin",{key:window.localStorage.sessionkey,location:"/home"}),r.on("userLoggedin",function(t){return"/home"===t.location?(e.loggedin=!0,window.location="#/dashboard"):void 0})}return e.$inject=["$scope","$ionicModal","socket"],e}()),e.controller("recommendationController",u=function(){function e(e,t,r,n,o){this.$scope=e,this.InfoRequestService=t,this.socket=n,this.$location=o,e.isLoading=!0,n.emit("GetListOfPlatforms",{data:"1"}),n.on("platformsFound",function(t){return e.platforms=t,e.isLoading=!1})}return e.$inject=["$scope","InfoRequestService","$ionicModal","socket","$location"],e}()),e.controller("searchController",m=function(){function e(e,r,n,o,a){var i;this.$scope=e,this.InfoRequestService=r,this.socket=o,this.$location=a,e.myLibrary=!1,e.isLoading=!1,e.scoreName="avgscore",e.loggedin=!0,e.SearchForAGame=!1,t(n,e,o,r),i=a.search(),e.getGame=function(){return e.isLoading=!0,e.resultsFor=e.search,r.searchForAGame(e.resultsFor,function(t){return e.gamesfound=[],e.gamesfound=t.results.length>20?t.results.slice(0,20):t.results,o.emit("searchForGames",{list:e.gamesfound})})},o.on("searchfinished",function(t){var r,n,o,a,i;for(e.games=[],a=0,i=t.length;i>a;a++)r=t[a],r.details?(n=r.details.guruscore,o=r.details.peerscore,n&&o?r.details.avgscore=(.75*n+1.25*o)/2:n?r.details.avgscore=n:o&&(r.details.avgscore=o)):(r.details={},r.details.avgscore=0),e.games.push(r);return e.setUpPages(),e.isLoading=!1}),"undefined"!=typeof i.game?(e.search=i.game,e.getGame()):(e.SearchForAGame=!0,e.isLoading=!1)}return e.$inject=["$scope","InfoRequestService","$ionicModal","socket","$location"],e}()),e.controller("dashboardController",r=function(){function e(e,r,n,o){this.$scope=e,this.InfoRequestService=r,this.socket=o,e.isLoading=!0,o.emit("GetRecentGames"),this.socket.on("recentReleases",function(t){return e.isLoading=!1,e.recentGames=t}),this.socket.on("noGames",function(){return e.isLoading=!1,e.recentGames=!1}),t(n,e,o,r)}return e.$inject=["$scope","InfoRequestService","$ionicModal","socket"],e}()),e.controller("peerController",l=function(){function e(e,r,n,o,a){var i;this.$scope=e,this.InfoRequestService=r,this.socket=o,this.$location=a,e.myLibrary=!1,e.scoreName="avgscore",e.isLoading=!0,i=a.search(),o.emit("GetListOfPlatforms",{data:"1"}),o.on("platformsFound",function(t){return e.platforms=t}),e.currentPlatform=i.platform,o.emit("GetPeerLibrary",i.platform),this.socket.on("peerLibraryFound",function(t){var r,n,o,a,i,s;for(e.games=[],s=t[0],a=0,i=s.length;i>a;a++)r=s[a],n=r.guruscore,o=r.peerscore,n&&o?r.avgscore=(.75*n+1.25*o)/2:n?r.avgscore=n:o&&(r.avgscore=o),e.games.push(r);return e.setUpPages(),e.isLoading=!1}),t(n,e,o,r)}return e.$inject=["$scope","InfoRequestService","$ionicModal","socket","$location"],e}()),e.controller("guruController",o=function(){function e(e,r,n,o,a){var i;this.$scope=e,this.InfoRequestService=r,this.socket=o,this.$location=a,e.myLibrary=!1,e.scoreName="avgscore",e.isLoading=!0,i=a.search(),o.emit("GetListOfPlatforms",{data:"1"}),e.updatePlatform=function(t){return e.isLoading=!0,o.emit("GetGuruLibrary",t),e.currentPlatform=t},o.on("platformsFound",function(t){return e.platforms=t}),e.updatePlatform(i.platform),this.socket.on("guruLibraryFound",function(t){var r,n,o,a,i,s;for(e.games=[],s=t[0],a=0,i=s.length;i>a;a++)r=s[a],n=r.guruscore,o=r.peerscore,n&&o?r.avgscore=(.75*n+1.25*o)/2:n?r.avgscore=n:o&&(r.avgscore=o),e.games.push(r);return e.setUpPages(),e.isLoading=!1}),t(n,e,o,r)}return e.$inject=["$scope","InfoRequestService","$ionicModal","socket","$location"],e}()),e.controller("genericController",n=function(){function e(e){this.$scope=e,e.contact=!1}return e.$inject=["$scope"],e}()),e.controller("libraryController",s=function(){function e(e,r,n,o,a){var i;this.$scope=e,this.InfoRequestService=r,this.socket=o,this.$location=a,e.loggedin=!0,e.myLibrary=!0,e.NoLibraryError=!1,e.scoreName="rating",e.gameSelected=!1,e.isLoading=!0,e.editMode=!1,e.saveLibraryEdit=function(){return o.emit("UpdateUserLibraryInfo",e.user),e.editMode=!1},e.toggleEditMode=function(){return e.editMode=!e.editMode},i=a.path(),i=i.substring(1),e.Username=i,o.emit("GetLibrary",i),this.socket.on("init",function(){}),this.socket.on("noLibraryFound",function(){return e.NoLibraryError=!0}),this.socket.on("gameLibraryFound",function(t){var r,n,o,a,i,s;for(e.localLibrary=t.myLibrary,e.user=t.user[0],e.games=[],s=t.games,a=0,i=s.length;i>a;a++)r=s[a],n=r.guruscore,o=r.peerscore,n&&o?r.avgscore=(.75*n+1.25*o)/2:n?r.avgscore=n:o&&(r.avgscore=o),e.games.push(r);return e.setUpPages(),e.isLoading=!1}),n.fromTemplateUrl("views/addGameModal.html",{scope:e,animation:"slide-in-up"}).then(function(t){return e.modal=t,e.modalGame={}}),e.searchForAGame=function(t){return e.isLoadingAdder=!0,r.searchForAGame(t,function(t){return e.gamesfound=t.results,e.isLoadingAdder=!1})},e.addNewGame=function(){return e.modal.show(),e.canFlip="false",e.gameSelected=!1},e.editUserResponse=function(){},e.closeModal=function(){return e.newgame={},e.gamesfound={},e.modal.hide()},e.addGameToLibrary=function(t){return e.newgame={},e.canFlip="flip",e.newgame.userInfo={},e.newgame.giantBombinfo={},e.newgame.giantBombinfo.giantBomb_id=t.id,e.newgame.giantBombinfo.game_name=t.name,e.newgame.giantBombinfo.game_picture=t.image.medium_url,e.newgame.giantBombinfo.description=t.deck,e.newgame.platforms=t.platforms,e.newgame.userInfo.rating=3,e.newgame.userInfo.enjoyment=3,e.newgame.userInfo.length=3,e.newgame.userInfo.unenjoyment=3,e.newgame.userInfo.difficulty=3,e.gameSelected=!0},e.goback=function(){return e.canFlip="false",e.gameSelected=!1},e.saveGame=function(){return o.emit("AddNewGameToLibrary",e.newgame),e.closeModal()},n.fromTemplateUrl("views/detailsLibraryModal.html",{scope:e,animation:"slide-in-up"}).then(function(t){return e.detailsModal=t}),e.closeLibraryDetails=function(){return e.detailsModal.hide()},e.getGameDetails=function(t){return e.gamedetails=t,e.gamedetails.reviewLink=a.absUrl(),e.detailsModal.show()},n.fromTemplateUrl("views/editScoreModal.html",{scope:e,animation:"slide-in-up"}).then(function(t){return e.editModal=t,e.edit={}}),e.closeEdit=function(){return e.editModal.hide(),e.edit={}},e.showEdit=function(t){return e.edit=t,e.editModal.show()},e.updateGame=function(){return o.emit("updateGame",e.edit),e.editModal.hide()},t(n,e,o,r)}return e.$inject=["$scope","InfoRequestService","$ionicModal","socket","$location"],e}())}).call(this);